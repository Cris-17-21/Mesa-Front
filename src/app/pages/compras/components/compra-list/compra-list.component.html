<div class="card">
    <div class="flex justify-content-between align-items-center mb-4">
        <h2 class="m-0 text-2xl font-bold">Gestión de Compras</h2>
        <p-button label="Nueva Compra" icon="bi bi-plus" (onClick)="createCompra()" severity="primary">
        </p-button>
    </div>

    <p-table [value]="compras" [loading]="loading" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
        currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} compras"
        [rowsPerPageOptions]="[10, 25, 50]" styleClass="p-datatable-striped p-datatable-sm" responsiveLayout="scroll">

        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="referencia">Referencia <p-sortIcon field="referencia"></p-sortIcon></th>
                <th pSortableColumn="razonSocialProveedor">Proveedor <p-sortIcon
                        field="razonSocialProveedor"></p-sortIcon></th>
                <th pSortableColumn="fechaPedido">Fecha <p-sortIcon field="fechaPedido"></p-sortIcon></th>
                <th pSortableColumn="totalPedido">Total <p-sortIcon field="totalPedido"></p-sortIcon></th>
                <th pSortableColumn="estadoPedido">Estado <p-sortIcon field="estadoPedido"></p-sortIcon></th>
                <th style="width: 100px">Acciones</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-compra>
            <tr>
                <td>{{ compra.referencia || '—' }}</td>
                <td>{{ compra.razonSocialProveedor || 'N/A' }}</td>
                <td>{{ compra.fechaPedido | date:'dd/MM/yyyy HH:mm' }}</td>
                <td>{{ compra.totalPedido | currency:'PEN':'S/ ' }}</td>
                <td>
                    <p-tag [value]="compra.estadoPedido" [severity]="getSeverity(compra.estadoPedido)"></p-tag>
                </td>
                <td>
                    <div class="flex gap-2">
                        <p-button icon="bi bi-eye" [rounded]="true" [text]="true" pTooltip="Ver Detalle"
                            tooltipPosition="top">
                        </p-button>
                    </div>
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="6" class="text-center p-4">No se encontraron compras.</td>
            </tr>
        </ng-template>
    </p-table>
</div>