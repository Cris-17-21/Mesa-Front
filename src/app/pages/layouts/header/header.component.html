<header class="main-header">
  <div class="header-left">
    <div class="logo">
      <span class="logo-icon">üçΩÔ∏è</span>
      <span class="logo-text">NOIR<span class="zinc">POS</span></span>
    </div>
  </div>

  <div class="header-right">
    @if (!authService.isSuperAdmin()) {
      <div class="branch-selector" (click)="cambiarSede()">
        <i class="bi bi-geo-alt-fill"></i>
        <span class="branch-name">{{ sedeActual() }}</span>
        <i class="bi bi-arrow-left-right ms-2"></i>
      </div>
    }

    <button class="header-icon-btn" (click)="op.toggle($event)">
      <i class="bi bi-bell"></i>
      @if (unreadCount() > 0) {
        <span class="badge">{{ unreadCount() }}</span>
      }
    </button>

    <div class="user-pill">
      <div class="user-data">
        <span class="u-name">{{ username() }}</span>
        <span class="u-role">{{ authService.isSuperAdmin() ? 'SUPERADMIN' : 'ADMINISTRADOR' }}</span>
      </div>
      <button class="logout-btn" (click)="logout()">
        <i class="bi bi-power"></i>
      </button>
    </div>
  </div>
</header>

<p-overlayPanel #op [style]="{ width: '350px' }" styleClass="noir-notifications">
  <div class="notif-header">
    <h3>Notificaciones</h3>
    <button (click)="marcarComoLeidas()">Marcar como le√≠das</button>
  </div>
  
  <div class="notif-body">
    @for (n of notificaciones(); track n.id) {
      <div class="notif-item" [class.unread]="!n.leido">
        <div class="notif-icon">üîî</div>
        <div class="notif-content">
          <p class="notif-title">{{ n.titulo }}</p>
          <p class="notif-desc">{{ n.mensaje }}</p>
          <span class="notif-time">{{ n.tiempo }}</span>
        </div>
      </div>
    } @empty {
      <div class="notif-empty">No hay notificaciones nuevas</div>
    }
  </div>
  
  <div class="notif-footer">
    <button>Ver todo el historial</button>
  </div>
</p-overlayPanel>