import { Router, Routes } from '@angular/router';
import { authGuard } from './core/auth/auth.guard';
import { LoginComponent } from './pages/auth/login/login.component';
import { MainLayoutComponent } from './pages/layouts/main-layout/main-layout.component';

export const routes: Routes = [
  {
    path: 'login',
    component: LoginComponent,
  },
  {
    path: '',
    component: MainLayoutComponent,
    canActivate: [authGuard],
    children: [
      { path: '', redirectTo: 'dashboard', pathMatch: 'full' },
      {
        path: 'dashboard',
        loadComponent: () => import('./pages/dashboard/dashboard.component').then(m => m.DashboardComponent)
      },
      // --- CONFIGURACIÓN ---
      {
        path: 'config',
        children: [
          {
            path: 'permission',
            loadComponent: () => import('./pages/config/permissions/permissions.component').then(m => m.PermissionsComponent)
          },
          {
            path: 'modules',
            loadComponent: () => import('./pages/config/modules/modules.component').then(m => m.ModulesComponent)
          },
          {
            path: 'roles',
            loadComponent: () => import('./pages/config/roles/roles.component').then(m => m.RolesComponent)
          },
          {
            path: 'users',
            loadComponent: () => import('./pages/config/users/users.component').then(m => m.UsersComponent)
          }
        ]
      },
      // --- MAESTROS ---
      {
        path: 'maestros',
        children: [
          {
            path: 'empresa',
            loadComponent: () => import('./pages/maestro/empresa/empresa.component').then(m => m.EmpresaComponent)
          },
          {
            path: 'sucursal',
            loadComponent: () => import('./pages/maestro/sucursal/sucursal.component').then(m => m.SucursalComponent)
          },
          {
            path: 'pisos',
            loadComponent: () => import('./pages/maestro/piso/piso.component').then(m => m.PisoComponent)
          },
          {
            path: 'mesas',
            loadComponent: () => import('./pages/maestro/mesa/mesa.component').then(m => m.MesaComponent)
          },
          {
            path: 'clientes',
            loadComponent: () => import('./pages/maestro/cliente/cliente.component').then(m => m.ClienteComponent)
          }
        ]
      },
      // --- VENTAS (AQUÍ HICE EL CAMBIO CLAVE) ---
      {
        path: 'ventas',
        children: [
          {
            path: 'caja',
            loadComponent: () => import('./pages/venta/caja/caja.component').then(m => m.CajaComponent)
          },
          {
            // RUTA PADRE: /ventas/pos
            path: 'pos',
            children: [
              {
                // RUTA DEFAULT: /ventas/pos -> Muestra el MAPA
                path: '',
                loadComponent: () => import('./pages/venta/pos/piso-mapa/piso-mapa.component').then(m => m.PisoMapaComponent),
                title: 'Selección de Mesa'
              }
            ]
          },
          {
            path: 'pre-cuenta',
            loadComponent: () => import('./pages/venta/pre-cuenta/pre-cuenta.component').then(m => m.PreCuentaComponent)
          }
        ]
      },
      // --- COMPRAS ---
      {
        path: 'compras',
        children: [
          {
            path: 'prooductos', // Ojo: tienes un typo aquí 'prooductos', tal vez quieras corregirlo a 'productos'
            loadComponent: () => import('./pages/compras/components/compra-list/compra-list.component').then(m => m.CompraListComponent)
          }
        ]
      }
    ]
  },
  {
    path: '**',
    redirectTo: 'login'
  }
];